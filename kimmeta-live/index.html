<!DOCTYPE html>
<html lang="ko">
<head>
<!-- Google Tag Manager -->
<script>
    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id=GTM-NMR4ZWSL'+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-NMR4ZWSL');
    </script>
    <!-- End Google Tag Manager -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="scroll-restoration" content="manual">
    <title>김메타 무료 라이브 사전등록</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        // 환경 변수 설정 (배포 시 실제 값으로 교체)
        const WEB_APP_URL = "https://script.google.com/macros/s/AKfycby65jGAvu7d2Xv7Cv3cy1aB9kGMnzbbPTPgoLfcMByfeOssNXjQvmfq9fbNNk4lSiuyvg/exec";
        const SHARED_SECRET = "frontend_backend_shared_secret";
        
        // 강사 정보 설정 (각 강사별로 수정 필요)
        const INSTRUCTOR_NAME = "김메타"; // 예: "캐시루트", "사뚜", "김메타"
        const INSTRUCTOR_ID = "kimmeta"; // 예: "cashroot", "sattu", "kimmeta"
        
        // URL 도메인에서 광고 소스 감지
        function getAdSource() {
            const hostname = window.location.hostname;
            
            // GDN 도메인 감지
            if (hostname.includes('gdn')) {
                return 'GDN';
            }
            // Meta 도메인 감지
            else if (hostname.includes('meta')) {
                return 'Meta';
            }
            
            // 기본값
            return 'Direct';
        }
        
        // 페이지 로드 시 광고 소스 감지
        let adSource = getAdSource();
        
    </script>
    <style>
        /* 모바일 최적화 스타일 */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f5f5f5;
            margin: 0;
            padding: 0;
            scroll-behavior: auto;
        }
        
        html {
            scroll-behavior: auto;
        }
        
        /* 메인 컨테이너 */
        .main-container {
            max-width: 800px;
            margin: 0 auto;
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            min-height: 100vh;
        }
        
        /* 이미지 갤러리 컨테이너 */
        .image-gallery {
            max-width: 100%;
            margin: 0 auto;
            padding: 0;
            font-size: 0;
            line-height: 0;
            display: flex;
            flex-direction: column;
        }
        
        /* 갤러리 이미지 스타일 */
        .gallery-image {
            width: 100%;
            height: auto;
            display: block;
            object-fit: cover;
            transition: opacity 0.3s ease;
        }
        
        /* 폼 컨테이너 */
        .form-container {
            background-color: #ffffff;
            margin: 0;
            padding: 20px;
        }
        
        /* 로딩 상태 스타일 */
        .loading {
            opacity: 0.6;
            pointer-events: none;
        }
        
        /* 토스트 알림 스타일 */
        .toast {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 1000;
            max-width: 90%;
        }
        
        /* 플로팅 버튼 스타일 */
        .floating-button {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 10000;
            width: calc(100% - 40px);
            max-width: 400px;
            height: 60px;
            display: block;
            transition: all 0.3s ease;
        }
        
        /* 폼 영역에서 고정 위치로 변경 */
        .floating-button.in-form {
            position: relative !important;
            bottom: 0 !important;
            left: 0 !important;
            transform: none !important;
            width: 100% !important;
            max-width: none !important;
            margin: 20px 0 !important;
            z-index: 1 !important;
        }
        
        .floating-button a {
            display: block;
            background: linear-gradient(135deg, #F97316 0%, #EA580C 100%);
            color: #fff;
            height: 60px;
            line-height: 60px;
            border-radius: 12px;
            text-decoration: none;
            text-align: center;
            font-weight: bold;
            font-size: 16px;
            box-shadow: 0 8px 25px rgba(249, 115, 22, 0.3);
            transition: all 0.3s ease;
        }
        
        .floating-button a:hover {
            background: linear-gradient(135deg, #EA580C 0%, #DC2626 100%);
            transform: translateY(-3px);
            box-shadow: 0 12px 30px rgba(249, 115, 22, 0.4);
        }
        
        /* 모바일 반응형 */
        @media (max-width: 768px) {
            .main-container {
                max-width: 100%;
                margin: 0;
            }
            
            .form-container {
                padding: 15px;
            }
            
            .floating-button {
                width: calc(100% - 30px);
                bottom: 15px;
            }
        }
        
        @media (max-width: 480px) {
            .form-container {
                padding: 10px;
            }
            
            .floating-button {
                width: calc(100% - 20px);
                bottom: 10px;
            }
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NMR4ZWSL"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->

    <div class="main-container">
        <!-- 이미지 갤러리 영역 (동적 로딩) -->
        <div class="image-gallery" id="beforeForm">
            <!-- 이미지들이 동적으로 로드됩니다 -->
        </div>

        <!-- 교육 콘텐츠 영역 -->
        <div class="educational-content py-16 px-6">
            <div class="max-w-4xl mx-auto">
                <div class="text-center mb-16">
                    <h2 class="text-4xl font-bold text-gray-900 mb-4">무료 라이브 특별 혜택</h2>
                    <p class="text-lg text-gray-600">전문가와 함께하는 특별한 시간</p>
                </div>
                
                <!-- <div class="grid md:grid-cols-2 gap-8 mb-12">
                    <div class="bg-white rounded-xl p-6 shadow-lg border-l-4 border-orange-300">
                        <h3 class="text-xl font-bold text-orange-600 mb-4">📚 이번 라이브에서 배울 내용</h3>
                        <ul class="space-y-3 text-gray-700">
                            <li class="flex items-start">
                                <span class="text-green-500 mr-2">✓</span>
                                <span>메타 광고 마스터 클래스</span>
                            </li>
                            <li class="flex items-start">
                                <span class="text-green-500 mr-2">✓</span>
                                <span>고객 타겟팅 및 픽셀 설정</span>
                            </li>
                            <li class="flex items-start">
                                <span class="text-green-500 mr-2">✓</span>
                                <span>광고 크리에이티브 최적화</span>
                            </li>
                            <li class="flex items-start">
                                <span class="text-green-500 mr-2">✓</span>
                                <span>ROI 극대화 전략</span>
                            </li>
                        </ul>
                    </div>
                    
                    <div class="bg-white rounded-xl p-6 shadow-lg border-l-4 border-orange-400">
                        <h3 class="text-xl font-bold text-orange-500 mb-4">🎁 특별 혜택</h3>
                        <ul class="space-y-3 text-gray-700">
                            <li class="flex items-start">
                                <span class="text-yellow-500 mr-2">🎯</span>
                                <span>메타 광고 가이드북 제공</span>
                            </li>
                            <li class="flex items-start">
                                <span class="text-yellow-500 mr-2">🎯</span>
                                <span>광고 템플릿 무료 제공</span>
                            </li>
                            <li class="flex items-start">
                                <span class="text-yellow-500 mr-2">🎯</span>
                                <span>1:1 광고 상담 기회</span>
                            </li>
                        </ul>
                    </div>
                </div> -->

                <!-- 강사 소개
                <div class="bg-white rounded-xl p-8 shadow-lg mb-8">
                    <div class="flex flex-col md:flex-row items-start">
                        <div class="md:w-1/3 mb-6 md:mb-0">
                            <div class="w-48 h-48 mx-auto shadow-lg rounded-lg overflow-hidden bg-gray-100">
                                <div class="w-full h-full bg-gradient-to-br from-orange-400 to-red-500 flex items-center justify-center text-white text-4xl font-bold">
                                    김메타
                                </div>
                            </div> -->
                            <!-- 오렌지색 성과 배너                          <div class="bg-orange-500 text-white rounded-lg p-4 mt-4 text-center">
                                <div class="text-sm font-bold mb-2">주요 성과</div>
                                <div class="text-xs space-y-1">
                                    <div>• 메타 광고 전문가</div>
                                    <div>• 광고 ROI 300% 달성</div>
                                </div>
                            </div>
                        </div>
                        <div class="md:w-2/3 md:pl-8">
                            <h3 class="text-2xl font-bold text-gray-800 mb-4">김메타 강사를 소개합니다🔥</h3>
                            <div class="text-gray-700 space-y-3">
                                <p>
                                    메타 광고 전문가 <strong>김메타</strong> 입니다.
                                </p>
                                <p>
                                    <strong>메타 광고</strong> 분야에서 5년 이상의 경험을 바탕으로 
                                    수많은 기업의 광고 성과를 극대화시켰습니다.
                                </p>
                                <p>
                                    핵심은 <strong>'정확한 타겟팅'</strong>과 <strong>'크리에이티브 최적화'</strong>입니다. 
                                    데이터 기반의 전략적 접근으로 
                                    광고비 대비 <strong>ROI 300%</strong>를 달성합니다.
                                </p>
                                <p>
                                    초보자도 쉽게 따라할 수 있는 단계별 메타 광고 마스터 과정을 통해 
                                    누구나 성공적인 광고를 운영할 수 있도록 도와드립니다.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>  -->

                <!-- 카운트다운 타이머 -->
                <div class="bg-white rounded-2xl p-8 shadow-xl border border-gray-100 mb-12">
                    <div class="text-center">
                        <h3 class="text-2xl font-bold text-gray-900 mb-2">무료 라이브까지 남은 시간</h3>
                        <p class="text-gray-600 mb-8">2026년 1월 28일 오후 8시까지</p>
                        <div id="countdown-timer" class="text-center">
                            <div class="grid grid-cols-2 md:grid-cols-4 gap-6">
                                <div class="bg-gradient-to-br from-orange-500 to-red-500 rounded-xl p-6 text-white">
                                    <div id="days" class="text-3xl font-bold mb-1">00</div>
                                    <div class="text-sm opacity-90">일</div>
                                </div>
                                <div class="bg-gradient-to-br from-orange-500 to-red-500 rounded-xl p-6 text-white">
                                    <div id="hours" class="text-3xl font-bold mb-1">00</div>
                                    <div class="text-sm opacity-90">시간</div>
                                </div>
                                <div class="bg-gradient-to-br from-orange-500 to-red-500 rounded-xl p-6 text-white">
                                    <div id="minutes" class="text-3xl font-bold mb-1">00</div>
                                    <div class="text-sm opacity-90">분</div>
                                </div>
                                <div class="bg-gradient-to-br from-orange-500 to-red-500 rounded-xl p-6 text-white">
                                    <div id="seconds" class="text-3xl font-bold mb-1">00</div>
                                    <div class="text-sm opacity-90">초</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- FAQ 섹션 -->
                <div class="bg-white rounded-2xl p-8 shadow-xl border border-gray-100 mb-12">
                    <div class="text-center mb-8">
                        <h3 class="text-2xl font-bold text-gray-900 mb-2">자주 묻는 질문</h3>
                        <p class="text-gray-600">궁금한 점들을 미리 확인해보세요</p>
                    </div>
                    <div class="space-y-6">
                        <div class="border-l-4 border-orange-500 bg-gray-50 rounded-r-lg p-6">
                            <h4 class="font-semibold text-gray-900 mb-2">Q. 라이브는 정말 무료인가요?</h4>
                            <p class="text-gray-700">네, 완전 무료입니다. 별도의 비용이나 구매 의무는 없습니다.</p>
                        </div>
                        <div class="border-l-4 border-orange-500 bg-gray-50 rounded-r-lg p-6">
                            <h4 class="font-semibold text-gray-900 mb-2">Q. 초보자도 참여할 수 있나요?</h4>
                            <p class="text-gray-700">물론입니다. 기초부터 차근차근 설명드리며, Q&A 시간도 있습니다.</p>
                        </div>
                        <div class="border-l-4 border-orange-500 bg-gray-50 rounded-r-lg p-6">
                            <h4 class="font-semibold text-gray-900 mb-2">Q. 라이브 시간은 언제인가요?</h4>
                            <p class="text-gray-700">무료라이브 신청하시면 전용 단톡방에서 라이브 일정을 안내해드립니다.</p>
                        </div>
                        <div class="border-l-4 border-orange-500 bg-gray-50 rounded-r-lg p-6">
                            <h4 class="font-semibold text-gray-900 mb-2">Q. 개인정보는 안전한가요?</h4>
                            <p class="text-gray-700">네, 수집된 정보는 라이브 알림 목적으로만 사용되며, 따로 저장하지 않습니다.</p>
                        </div>
                    </div>
                </div>

                <!-- 교육 가치 섹션 -->
                <div class="bg-white rounded-2xl p-8 shadow-xl border border-gray-100 mb-12">
                    <div class="text-center mb-8">
                        <h3 class="text-2xl font-bold text-gray-900 mb-2">교육적 가치</h3>
                        <p class="text-gray-600">실제로 도움이 되는 교육 내용</p>
                    </div>
                    <div class="grid md:grid-cols-3 gap-8">
                        <div class="text-center p-6 bg-gradient-to-br from-orange-50 to-red-50 rounded-xl">
                            <div class="w-16 h-16 bg-gradient-to-br from-orange-500 to-red-500 rounded-full flex items-center justify-center mx-auto mb-4">
                                <span class="text-2xl">📈</span>
                            </div>
                            <h4 class="font-bold text-gray-900 mb-3">실전 구매대행 노하우</h4>
                            <p class="text-sm text-gray-600">이론이 아닌 실제 구매대행에서 바로 적용할 수 있는 실전 노하우</p>
                        </div>
                        <div class="text-center p-6 bg-gradient-to-br from-orange-50 to-red-50 rounded-xl">
                            <div class="w-16 h-16 bg-gradient-to-br from-orange-500 to-red-500 rounded-full flex items-center justify-center mx-auto mb-4">
                                <span class="text-2xl">💡</span>
                            </div>
                            <h4 class="font-bold text-gray-900 mb-3">전문가 인사이트</h4>
                            <p class="text-sm text-gray-600">해외 구매대행 전문가가 공개하는 구매대행 전략</p>
                        </div>
                        <div class="text-center p-6 bg-gradient-to-br from-orange-50 to-red-50 rounded-xl">
                            <div class="w-16 h-16 bg-gradient-to-br from-orange-500 to-red-500 rounded-full flex items-center justify-center mx-auto mb-4">
                                <span class="text-2xl">🤝</span>
                            </div>
                            <h4 class="font-bold text-gray-900 mb-3">실시간 Q&A</h4>
                            <p class="text-sm text-gray-600">실시간 Q&A 시간</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 폼 카드 영역 -->
        <div class="form-container" id="boxAll">
            <div class="bg-gradient-to-r from-orange-500 to-red-500 text-white rounded-2xl p-8 mb-8 shadow-xl">
                <div class="text-center">
                    <h2 class="text-3xl font-bold mb-3">지금 바로 무료 등록하세요!</h2>
                    <p class="text-lg opacity-90 mb-6">제한된 인원만 참여 가능한 특별 라이브 세션</p>
                    <div class="flex justify-center items-center space-x-8">
                        <div class="text-center">
                            <div class="w-12 h-12 bg-white bg-opacity-20 rounded-full flex items-center justify-center mx-auto mb-2">
                                <span class="text-xl">⏰</span>
                            </div>
                            <div class="text-sm font-medium">제한된 시간</div>
                        </div>
                        <div class="text-center">
                            <div class="w-12 h-12 bg-white bg-opacity-20 rounded-full flex items-center justify-center mx-auto mb-2">
                                <span class="text-xl">👥</span>
                            </div>
                            <div class="text-sm font-medium">소수 정예</div>
                        </div>
                        <div class="text-center">
                            <div class="w-12 h-12 bg-white bg-opacity-20 rounded-full flex items-center justify-center mx-auto mb-2">
                                <span class="text-xl">🎁</span>
                            </div>
                            <div class="text-sm font-medium">특별 혜택</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <form id="registrationForm" class="space-y-4">
                <!-- 이름 입력 -->
                <div>
                    <label for="name" class="block text-sm font-medium text-gray-700 mb-1">
                        이름 <span class="text-red-500">*</span>
                    </label>
                    <input 
                        type="text" 
                        id="name" 
                        name="name"
                        required
                        minlength="2"
                        maxlength="30"
                        autocomplete="name"
                        class="w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                        style="min-height: 44px;"
                        placeholder="이름을 입력해주세요"
                    />
                    <div id="nameError" class="text-red-500 text-sm mt-1 hidden"></div>
                </div>

                <!-- 전화번호 입력 -->
                <div>
                    <label for="phone" class="block text-sm font-medium text-gray-700 mb-1">
                        전화번호 <span class="text-red-500">*</span>
                    </label>
                    <input 
                        type="tel" 
                        id="phone" 
                        name="phone"
                        required
                        pattern="^01[0-9]-?[0-9]{3,4}-?[0-9]{4}$"
                        inputmode="numeric"
                        autocomplete="tel"
                        class="w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                        style="min-height: 44px;"
                        placeholder="010-1234-5678"
                    />
                    <div id="phoneError" class="text-red-500 text-sm mt-1 hidden"></div>
                </div>

                <!-- 개인정보 동의 -->
                <div class="flex items-start space-x-2">
                    <input 
                        type="checkbox" 
                        id="consent" 
                        name="consent"
                        required
                        class="mt-1 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"
                    />
                    <label for="consent" class="text-sm text-gray-700">
                        <span class="text-red-500">*</span> 개인정보 수집 및 이용에 동의합니다
                        <button 
                            type="button" 
                            id="privacyBtn"
                            class="ml-1 text-xs text-blue-600 hover:text-blue-800 underline"
                        >
                            자세히보기
                        </button>
                        <br><span class="text-xs text-gray-500">(이름, 전화번호는 라이브 알림 목적으로만 사용됩니다)</span>
                    </label>
                </div>
                <div id="consentError" class="text-red-500 text-sm hidden"></div>

                <!-- 허니팟 필드 (스팸 방지) -->
                <input type="text" name="website" style="display: none;" tabindex="-1" autocomplete="off">

                <!-- 폼 내부 제출 버튼 (숨김 처리) -->
                <button 
                    type="submit"
                    id="submitBtn"
                    class="w-full text-white py-3 px-4 rounded-xl font-medium focus:ring-2 focus:ring-offset-2 transition-all duration-300"
                    style="display: none; min-height: 44px; background: linear-gradient(135deg, #F97316 0%, #EA580C 100%);"
                    onmouseover="this.style.background='linear-gradient(135deg, #EA580C 0%, #DC2626 100%)'"
                    onmouseout="this.style.background='linear-gradient(135deg, #F97316 0%, #EA580C 100%)'"
                >
                    무료라이브 신청하기
                </button>
            </form>
        </div>
    </div>

    <!-- 하단 고정 CTA 버튼 -->
    <div class="floating-button" id="floating-btn">
        <a href="#boxAll" onclick="event.preventDefault(); document.getElementById('boxAll').scrollIntoView({ behavior: 'smooth' });">
            무료라이브 신청하기
        </a>
    </div>
    </div>

    <!-- Footer -->
    <footer class="bg-gradient-to-r from-gray-800 to-gray-900 text-white py-6 mt-8">
        <div class="max-w-4xl mx-auto px-6">
            <div class="grid md:grid-cols-2 gap-6">
                <div>
                    <h3 class="text-lg font-bold mb-3 text-orange-400">비즈부스트</h3>
                    <div class="text-sm text-gray-300 space-y-1">
                        <p><strong>대표:</strong> 박선경</p>
                        <p><strong>대표번호:</strong> 070-8080-4651</p>
                        <p><strong>사업자등록번호:</strong> 769-06-03020</p>
                        <p><strong>통신판매신고:</strong> 2025-경기김포-8059</p>
                    </div>
                </div>
                <div>
                    <h3 class="text-lg font-bold mb-3 text-orange-400">연락처 정보</h3>
                    <div class="text-sm text-gray-300 space-y-1">
                        <p><strong>주소:</strong> (10071) 경기 김포시 김포한강10로133번길 127</p>
                        <p class="ml-4">(구래동) 디원시티지식산업센터</p>
                        <p><strong>개인정보관리책임자:</strong> 박선경</p>
                        <p><strong>이메일:</strong> 2024bizboost@gmail.com</p>
                        <p><strong>고객센터:</strong> 카카오 채널톡</p>
                        <p><strong>운영시간:</strong> 10:00 ~ 18:00</p>
                    </div>
                </div>
            </div>
            <div class="border-t border-gray-600 mt-6 pt-4 text-center">
                <p class="text-xs text-gray-400">
                    ⓒ 2023. 비즈부스트. All rights reserved.
                </p>
            </div>
        </div>
    </footer>

    <!-- 토스트 알림 -->
    <div id="toast" class="toast hidden">
        <div class="bg-red-500 text-white px-4 py-2 rounded-lg shadow-lg">
            <span id="toastMessage"></span>
        </div>
    </div>

    <!-- 개인정보취급방침 모달 -->
    <div id="privacyModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-lg max-w-md w-full max-h-96 overflow-y-auto">
                <div class="p-6">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-lg font-bold text-gray-800">개인정보취급방침</h3>
                        <button 
                            id="closePrivacyModal"
                            class="text-gray-500 hover:text-gray-700 text-xl"
                        >
                            ×
                        </button>
                    </div>
                    <div class="text-sm text-gray-700 space-y-4">
                        <div>
                            <h4 class="font-semibold mb-2">가. 수집하는 개인정보 항목 및 수집방법</h4>
                            <p class="mb-2">수집 항목: 이름, 전화번호</p>
                            <p class="text-xs text-gray-500">수집 방법: 본 사전등록 폼을 통한 직접 수집</p>
                        </div>
                        <div>
                            <h4 class="font-semibold mb-2">나. 개인정보의 수집 및 이용목적</h4>
                            <p class="mb-2">수집한 개인정보를 다음의 목적을 위해 활용합니다:</p>
                            <ul class="list-disc list-inside text-xs space-y-1">
                                <li>무료 라이브 세션 일정 안내</li>
                                <li>라이브 참여를 위한 개별 연락</li>
                                <li>특별 혜택 및 추가 정보 제공</li>
                            </ul>
                        </div>
                        <div>
                            <h4 class="font-semibold mb-2">다. 수집한 개인정보의 보유 및 이용기간</h4>
                            <p class="mb-2">- 라이브 세션 종료 후 30일간 보관</p>
                            <p class="mb-2">- 목적 달성 후 즉시 파기</p>
                            <p class="text-xs text-gray-500">※ 법령에 의해 보관이 필요한 경우 해당 기간 준수</p>
                        </div>
                        <div>
                            <h4 class="font-semibold mb-2">라. 개인정보의 제3자 제공</h4>
                            <p class="text-xs text-gray-500">개인정보는 수집 및 이용목적 달성을 위해 필요한 경우를 제외하고는 제3자에게 제공되지 않습니다.</p>
                        </div>
                        <div>
                            <h4 class="font-semibold mb-2">마. 개인정보 처리의 위탁</h4>
                            <p class="text-xs text-gray-500">현재 개인정보 처리 위탁 업체는 없으며, 향후 위탁 시 본 방침을 통해 고지하겠습니다.</p>
                        </div>
                    </div>
                    <div class="mt-6 text-center">
                        <button 
                            id="closePrivacyModalBtn"
                            class="bg-pink-500 text-white px-4 py-2 rounded-lg hover:bg-pink-600"
                        >
                            확인
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 토스트 알림 -->
    <div id="toast" class="toast hidden">
        <div class="bg-red-500 text-white px-4 py-2 rounded-lg shadow-lg">
            <span id="toastMessage"></span>
        </div>
    </div>

    <!-- 개인정보취급방침 모달 -->
    <div id="privacyModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-lg max-w-md w-full max-h-96 overflow-y-auto">
                <div class="p-6">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-lg font-bold text-gray-800">개인정보취급방침</h3>
                        <button 
                            id="closePrivacyModal"
                            class="text-gray-500 hover:text-gray-700 text-xl"
                        >
                            ×
                        </button>
                    </div>
                    <div class="text-sm text-gray-700 space-y-4">
                        <div>
                            <h4 class="font-semibold mb-2">가. 수집하는 개인정보 항목 및 수집방법</h4>
                            <p>- 신청자 이름, 핸드폰</p>
                        </div>
                        <div>
                            <h4 class="font-semibold mb-2">나. 개인정보의 수집 및 이용목적</h4>
                            <p>수집한 개인정보를 다음의 목적을 위해 활용합니다.</p>
                            <p>- 혜택 및 이벤트 알림</p>
                        </div>
                        <div>
                            <h4 class="font-semibold mb-2">다. 수집한 개인정보의 보유 및 이용기간</h4>
                            <p>- 원칙적으로 개인정보 수집 및 이용목적이 달성된 후에는 해당 정보를 지체 없이 파기합니다.</p>
                        </div>
                    </div>
                    <div class="mt-6 text-center">
                        <button 
                            id="closePrivacyModalBtn"
                            class="bg-orange-600 text-white px-4 py-2 rounded-lg hover:bg-orange-700"
                        >
                            확인
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // DOM 요소 참조
        const form = document.getElementById('registrationForm');
        const floatingBtnLink = document.querySelector('#floating-btn a');
        const toast = document.getElementById('toast');
        const toastMessage = document.getElementById('toastMessage');

        // 입력 필드 참조
        const nameInput = document.getElementById('name');
        const phoneInput = document.getElementById('phone');
        const consentInput = document.getElementById('consent');
        const websiteInput = document.querySelector('input[name="website"]');

        // 에러 메시지 요소 참조
        const nameError = document.getElementById('nameError');
        const phoneError = document.getElementById('phoneError');
        const consentError = document.getElementById('consentError');

        // 정규식 패턴
        const phonePattern = /^01[0-9]-?[0-9]{3,4}-?[0-9]{4}$/;
        const namePattern = /^[가-힣a-zA-Z\s]{2,30}$/;

        // 토스트 메시지 표시 함수
        function showToast(message) {
            toastMessage.textContent = message;
            toast.classList.remove('hidden');
            setTimeout(() => {
                toast.classList.add('hidden');
            }, 3000);
        }

        // 에러 메시지 표시 함수
        function showError(element, message) {
            element.textContent = message;
            element.classList.remove('hidden');
        }

        // 에러 메시지 숨기기 함수
        function hideError(element) {
            element.classList.add('hidden');
        }

        // 입력값 검증 함수
        function validateForm() {
            let isValid = true;

            // 이름 검증
            const name = nameInput.value.trim();
            if (!name) {
                showError(nameError, '이름을 입력해주세요.');
                isValid = false;
            } else if (!namePattern.test(name)) {
                showError(nameError, '이름은 2-30자의 한글, 영문, 공백만 입력 가능합니다.');
                isValid = false;
            } else {
                hideError(nameError);
            }

            // 전화번호 검증
            const phone = phoneInput.value.trim();
            if (!phone) {
                showError(phoneError, '전화번호를 입력해주세요.');
                isValid = false;
            } else if (!phonePattern.test(phone)) {
                showError(phoneError, '올바른 전화번호 형식을 입력해주세요. (예: 010-1234-5678)');
                isValid = false;
            } else {
                hideError(phoneError);
            }

            // 개인정보 동의 검증
            if (!consentInput.checked) {
                showError(consentError, '개인정보 수집 및 이용에 동의해주세요.');
                isValid = false;
            } else {
                hideError(consentError);
            }

            // 허니팟 검증 (스팸 방지)
            if (websiteInput.value) {
                showToast('잘못된 요청입니다.');
                isValid = false;
            }

            return isValid;
        }

        // 전화번호 정규화 함수 (숫자만 추출)
        function normalizePhone(phone) {
            return phone.replace(/[^0-9]/g, '');
        }

        // JSONP 방식으로 폼 제출
        function submitViaJsonp(formData) {
            return new Promise((resolve, reject) => {
                // JSONP 콜백 함수 생성
                const callbackName = 'jsonpCallback_' + Date.now();
                
                // 전역 콜백 함수 등록
                window[callbackName] = function(result) {
                    // 정리
                    delete window[callbackName];
                    document.head.removeChild(script);
                    
                    if (result && result.ok) {
                        resolve(true);
                    } else {
                        reject(new Error(result?.detail || 'JSONP 전송 실패'));
                    }
                };

                // 스크립트 태그 생성
                const script = document.createElement('script');
                const params = new URLSearchParams({
                    callback: callbackName,
                    data: JSON.stringify(formData)
                });
                
                script.src = `${WEB_APP_URL}?${params.toString()}`;
                script.onerror = function() {
                    delete window[callbackName];
                    document.head.removeChild(script);
                    reject(new Error('JSONP 스크립트 로드 실패'));
                };

                // 타임아웃 설정
                setTimeout(() => {
                    if (window[callbackName]) {
                        delete window[callbackName];
                        document.head.removeChild(script);
                        reject(new Error('JSONP 타임아웃'));
                    }
                }, 10000);

                document.head.appendChild(script);
            });
        }

        // 폼 제출 함수
        async function submitForm() {
            if (!validateForm()) {
                return;
            }


            // 버튼 로딩 상태로 변경
            floatingBtnLink.style.pointerEvents = 'none';
            floatingBtnLink.textContent = '신청 중...';
            document.body.classList.add('loading');

            try {
                // 도메인에서 광고 소스 감지
                const currentAdSource = getAdSource();
                console.log('Ad Source:', currentAdSource);
                
                const formData = {
                    name: nameInput.value.trim(),
                    phone: normalizePhone(phoneInput.value.trim()),
                    consent: consentInput.checked,
                    instructorName: INSTRUCTOR_NAME,
                    instructorId: INSTRUCTOR_ID,
                    secret: SHARED_SECRET,
                    adsSource: currentAdSource
                };

                // CORS 문제 해결을 위한 다중 접근 방식
                let success = false;
                let errorMessage = '';

                // 방법 1: 직접 fetch 시도
                try {
                    const response = await fetch(WEB_APP_URL, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify(formData)
                    });

                    const result = await response.json();

                    if (result.ok) {
                        success = true;
                        window.location.href = 'https://open.kakao.com/o/gMH0nqQh';
                    } else {
                        errorMessage = result.detail || '신청 중 오류가 발생했습니다.';
                    }
                } catch (fetchError) {
                    
                    // 방법 2: JSONP 방식으로 시도
                    try {
                        success = await submitViaJsonp(formData);
                        if (success) {
                            window.location.href = 'https://open.kakao.com/o/gMH0nqQh';
                        } else {
                            errorMessage = 'JSONP 방식으로도 전송에 실패했습니다.';
                        }
                    } catch (jsonpError) {
                        errorMessage = '모든 전송 방법이 실패했습니다. 잠시 후 다시 시도해주세요.';
                    }
                }

                if (!success) {
                    showToast(errorMessage);
                }
            } catch (error) {
                showToast('네트워크 오류가 발생했습니다. 다시 시도해주세요.');
            } finally {
                // 버튼 상태 복구
                floatingBtnLink.style.pointerEvents = 'auto';
                floatingBtnLink.textContent = '무료라이브 신청하기';
                document.body.classList.remove('loading');
            }
        }

        // 이벤트 리스너 등록
        form.addEventListener('submit', (e) => {
            e.preventDefault();
            submitForm();
        });

        // 플로팅 버튼 클릭 시 폼 제출 트리거
        floatingBtnLink.addEventListener('click', (e) => {
            e.preventDefault();
            submitForm();
        });

        // 실시간 입력 검증
        nameInput.addEventListener('input', () => {
            if (nameInput.value.trim()) {
                hideError(nameError);
            }
        });

        phoneInput.addEventListener('input', () => {
            if (phoneInput.value.trim()) {
                hideError(phoneError);
            }
        });

        consentInput.addEventListener('change', () => {
            if (consentInput.checked) {
                hideError(consentError);
            }
        });


        // 리사이즈 이벤트 리스너 (화면 크기 변경 시)
        window.addEventListener('resize', () => {
            updateFloatingButtonVisibility();
        });

        // 플로팅 버튼 표시/숨김 로직
        const boxAll = document.getElementById('boxAll');
        const floatingBtn = document.getElementById('floating-btn');
        
        function updateFloatingButtonVisibility() {
            if (!boxAll || !floatingBtn) return;
            
            const boxAllRect = boxAll.getBoundingClientRect();
            const windowHeight = window.innerHeight;
            
            // 폼 영역이 화면에 보이는지 확인 (더 엄격한 조건)
            const isFormVisible = boxAllRect.top < windowHeight - 50 && boxAllRect.bottom > 50;
            
            if (isFormVisible) {
                // 폼 영역이 화면에 보이면 버튼을 폼 내부로 이동
                if (!floatingBtn.classList.contains('in-form')) {
                    floatingBtn.classList.add('in-form');
                    // 버튼을 폼의 마지막에 추가
                    const form = document.getElementById('registrationForm');
                    if (form) {
                        form.appendChild(floatingBtn);
                    }
                }
            } else {
                // 폼 영역이 화면에서 벗어나면 버튼을 다시 플로팅으로
                if (floatingBtn.classList.contains('in-form')) {
                    floatingBtn.classList.remove('in-form');
                    // 버튼을 body로 다시 이동
                    document.body.appendChild(floatingBtn);
                }
            }
        }
        
        // 스크롤 이벤트 리스너 (플로팅 버튼)
        window.addEventListener('scroll', () => {
            updateFloatingButtonVisibility();
        });
        
        // 초기 상태 설정
        updateFloatingButtonVisibility();

        // 동적 이미지 로딩 함수
        async function loadImages() {
            const imageGallery = document.getElementById('beforeForm');
            let imageNumber = 1;
            let hasMoreImages = true;
            let loadedCount = 0;
            
            while (hasMoreImages) {
                const imagePath = `./images/${String(imageNumber).padStart(3, '0')}.png`;
                
                // 이미지 존재 여부 확인
                try {
                    const response = await fetch(imagePath, { method: 'HEAD' });
                    if (response.ok) {
                        // 이미지가 존재하면 추가
                        const img = document.createElement('img');
                        img.src = imagePath;
                        img.alt = `무료 라이브 초대 이미지 ${imageNumber}`;
                        img.className = 'gallery-image';
                        imageGallery.appendChild(img);
                        loadedCount++;
                        imageNumber++;
                    } else {
                        // 이미지가 없으면 종료
                        hasMoreImages = false;
                    }
                } catch (error) {
                    // 네트워크 오류나 파일이 없으면 종료
                    hasMoreImages = false;
                }
            }
            
        }

        // 개인정보취급방침 모달 관련
        const privacyBtn = document.getElementById('privacyBtn');
        const privacyModal = document.getElementById('privacyModal');
        const closePrivacyModal = document.getElementById('closePrivacyModal');
        const closePrivacyModalBtn = document.getElementById('closePrivacyModalBtn');

        // 모달 열기
        privacyBtn.addEventListener('click', () => {
            privacyModal.classList.remove('hidden');
        });

        // 모달 닫기 (X 버튼)
        closePrivacyModal.addEventListener('click', () => {
            privacyModal.classList.add('hidden');
        });

        // 모달 닫기 (확인 버튼)
        closePrivacyModalBtn.addEventListener('click', () => {
            privacyModal.classList.add('hidden');
        });

        // 모달 배경 클릭 시 닫기
        privacyModal.addEventListener('click', (e) => {
            if (e.target === privacyModal) {
                privacyModal.classList.add('hidden');
            }
        });

        // ESC 키로 모달 닫기
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && !privacyModal.classList.contains('hidden')) {
                privacyModal.classList.add('hidden');
            }
        });

        // 카운트다운 타이머 함수
        function updateCountdown() {
            // 시간 설정 (2025년 10월 28일 오후 8시)
            const targetDate = new Date('2025-10-28T20:00:00+09:00');
            const now = new Date();
            
            // 시간 차이 계산 (밀리초)
            const timeDiff = targetDate.getTime() - now.getTime();
            
            if (timeDiff > 0) {
                // 남은 시간 계산
                const days = Math.floor(timeDiff / (1000 * 60 * 60 * 24));
                const hours = Math.floor((timeDiff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const minutes = Math.floor((timeDiff % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((timeDiff % (1000 * 60)) / 1000);
                
                // DOM 요소 업데이트
                document.getElementById('days').textContent = days.toString().padStart(2, '0');
                document.getElementById('hours').textContent = hours.toString().padStart(2, '0');
                document.getElementById('minutes').textContent = minutes.toString().padStart(2, '0');
                document.getElementById('seconds').textContent = seconds.toString().padStart(2, '0');
            } else {
                // 시간이 지났을 경우
                document.getElementById('days').textContent = '00';
                document.getElementById('hours').textContent = '00';
                document.getElementById('minutes').textContent = '00';
                document.getElementById('seconds').textContent = '00';
                
                // 타이머가 끝났음을 알리는 메시지
                const timerContainer = document.getElementById('countdown-timer');
                timerContainer.innerHTML = `
                    <div class="text-center">
                        <div class="text-2xl font-bold mb-2">🎉 라이브가 시작되었습니다!</div>
                        <p class="text-sm opacity-90">지금 바로 등록하세요!</p>
                    </div>
                `;
            }
        }

        // 강력한 스크롤 제어 함수
        function forceScrollToTop() {
            window.scrollTo(0, 0);
            document.documentElement.scrollTop = 0;
            document.body.scrollTop = 0;
            document.documentElement.scrollLeft = 0;
            document.body.scrollLeft = 0;
        }

        // 즉시 실행 (스크립트 로드 즉시)
        forceScrollToTop();

        // DOM 로드 시
        document.addEventListener('DOMContentLoaded', () => {
            forceScrollToTop();
        });

        // 페이지 로드 시 이미지 로딩 및 포커스 설정
        window.addEventListener('load', async () => {
            forceScrollToTop();
            
            // 여러 번 반복하여 확실하게
            setTimeout(() => forceScrollToTop(), 50);
            setTimeout(() => forceScrollToTop(), 100);
            setTimeout(() => forceScrollToTop(), 200);
            setTimeout(() => forceScrollToTop(), 500);
            
            await loadImages();
            
            // 이미지 로드 후에도 다시 확인
            forceScrollToTop();
            setTimeout(() => forceScrollToTop(), 100);
            
            // 카운트다운 타이머 초기화 및 시작
            updateCountdown();
            setInterval(updateCountdown, 1000); // 1초마다 업데이트
            
            nameInput.focus();
        });

        // 페이지 히스토리 복원 시에도 스크롤 위치 제어
        window.addEventListener('pageshow', (event) => {
            forceScrollToTop();
            setTimeout(() => forceScrollToTop(), 100);
        });

        // 스크롤 이벤트 감지하여 강제로 최상단 유지 (초기 로딩 중에만)
        let isInitialLoad = true;
        window.addEventListener('scroll', () => {
            if (isInitialLoad) {
                const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
                if (scrollTop > 0) {
                    forceScrollToTop();
                }
            }
        });

        // 3초 후에는 스크롤 제어 해제
        setTimeout(() => {
            isInitialLoad = false;
        }, 3000);
    </script>
</body>
</html>
